services:
  dev:
    build:
      context: .
      target: dev
    tty: true
    stdin_open: true
    volumes:
      - .:/app:cached
      - bundler:/bundle

  # Production MCP server
  reddit-mcp:
    build:
      context: .
      target: live
    image: reddit-mcp:latest
    stdin_open: true
    tty: true

    # Security hardening
    read_only: true
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL

volumes:
  bundler:
